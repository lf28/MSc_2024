<!-- PlutoStaticHTML.Begin -->
<!--
    # This information is used for caching.
    [PlutoStaticHTML.State]
    input_sha = "171e76a237d81d23fa608469f4e26c3d9db9d996b85a983aedd7d993a819d622"
    julia_version = "1.8.0"
-->
<pre class='language-julia'><code class='language-julia'>begin
    using Distributions, Random, LinearAlgebra, Plots
end</code></pre>


<pre class='language-julia'><code class='language-julia'>using StatsPlots</code></pre>



<div class="markdown"><h1>Maximum Likelihood estimation</h1>
<p><strong>Abstract</strong> <em>We review some basic maths techniques/concepts for frequentist&#39;s machine learning. We focus on maximum likelihood estimation &#40;MLE&#41; and its related techniques: specifically, conditional expectation, gradient descent, Newton&#39;s method, reparameterisation trick. Go through the following two notes if you have not yet read them.</em></p>
<ul>
<li><p><em>https://studres.cs.st-andrews.ac.uk/CS5014/Lectures/notes/maximum<em>likelihood</em>estimator.pdf</em></p>
</li>
<li><p><em>https://studres.cs.st-andrews.ac.uk/CS5014/Lectures/notes/MLE_multivarGaussian.pdf</em></p>
</li>
</ul>
</div>


<div class="markdown"><h3>Question 1</h3>
<p>Given a random sample, <span class="tex">$\mathcal&#123;D&#125;&#61;\&#123;d_1, d_2, \ldots, d_n\&#125;$</span>, from a Poisson distribution with unknown mean parameter <span class="tex">$\lambda.$</span> Estimate <span class="tex">$\lambda$</span> by maximum likelihood estimation. </p>
<ul>
<li><p>what is the log-likelihood function</p>
</li>
<li><p>what is the maximum likelihood estimator of <span class="tex">$\lambda$</span> </p>
</li>
<li><p>reparameterise log-likelihood function with <span class="tex">$\beta$</span> where <span class="tex">$\lambda &#61; \exp&#40;\beta&#41;$</span></p>
<ul>
<li><p>why doing this ?</p>
</li>
<li><p>use gradient descent to find the ML estimator &#40;you should implement it in Julia&#41;</p>
</li>
</ul>
</li>
</ul>
</div>

<pre class='language-julia'><code class='language-julia'>begin
    λ = rand() * 10
    n = 10000
    D2b = rand(Poisson(λ), n)
end</code></pre>
<pre id='var-n' class='code-output documenter-example-output'>10000-element Vector{Int64}:
 7
 6
 3
 7
 5
 7
 4
 ⋮
 0
 8
 2
 4
 2
 5</pre>


<div class="markdown"><h3>Question 2. Conditional expectation</h3>
<p>Conditional expectation is usually written as <span class="tex">$E&#91;Y|X&#61;x&#93;$</span>, note that capital letters are random variables while smaller case is a concrete value; <em>A good introduction to conditional expectation is Introduction to probability models by Sheldon Ross. You should read 2.4 and 3.1, 3.2, 3.3, and 3.4 if you do not know conditional expectation</em></p>
<ol>
<li><p>what is the definition of conditional expectation ?</p>
</li>
<li><p>is <span class="tex">$E&#91;Y|X&#61;x&#93;$</span> a function of <span class="tex">$x$</span> or <span class="tex">$y$</span> or <span class="tex">$X$</span>, <span class="tex">$Y$</span> ?</p>
</li>
<li><p>prove <span class="tex">$E\left&#91;E&#91;Y|X&#61;x&#93;\right&#93; &#61; E&#91;Y&#93;$</span>, with respect to what random variable&#39;s distribution the outer expectation is calculated ?</p>
</li>
</ol>
</div>


<div class="markdown"><h3>Question 3</h3>
<p>For linear regression, the model can be written as </p>
<p class="tex">$$y &#61; \boldsymbol&#123;x&#125;^\top \boldsymbol&#123;\beta&#125; &#43; \xi, \;\;\text&#123;where&#125;\;\; \xi \sim N&#40;0, \sigma^2&#41;,$$</p>
<p>Given data <span class="tex">$\boldsymbol&#123;y&#125; &#61; &#91;y_1, y_2, \ldots, y_n&#93;^\top$</span> and <span class="tex">$\boldsymbol&#123;X&#125; &#61; &#91;\boldsymbol&#123;x&#125;_1, \boldsymbol&#123;x&#125;_2, \ldots, \boldsymbol&#123;x&#125;_n&#93;^\top$</span> &#40;the data is given below&#41;;</p>
<ul>
<li><p>what is <span class="tex">$E&#91;y|\boldsymbol&#123;x&#125;&#93;$</span>? </p>
</li>
<li><p>what are the parameters of the model ?</p>
</li>
<li><p>what is the likelihood function ?</p>
</li>
<li><p>maximise the log-likelihood function by &#40;you should implement the algorithm in Julia&#41;</p>
<ul>
<li><p>normal equation or closed form solution</p>
</li>
<li><p>gradient descent</p>
</li>
<li><p>Newton&#39;s method &#40;check this <em>https://studres.cs.st-andrews.ac.uk/2020<em>2021/CS5014/Lectures/CS5014</em>L06<em>Logistic</em>regression<em>and</em>newton_method.pdf</em> if you do not know Newton&#39;s method&#41;</p>
</li>
</ul>
</li>
<li><p>is the MLE a random variable ? </p>
<ul>
<li><p>if so, where the &quot;randomness&quot; comes from ? </p>
</li>
<li><p>what is its distribution ? </p>
</li>
</ul>
</li>
</ul>
</div>

<pre class='language-julia'><code class='language-julia'>begin
    dim₃ = 5
    n₃ = 100
    β₃ = rand(dim₃)
    σ² = 0.5
    X = rand(n₃,dim₃)
    X[:,1] .= 1
    y₃ = rand.(Normal.(X * β₃, sqrt(σ²)))
end</code></pre>
<pre id='var-dim₃' class='code-output documenter-example-output'>100-element Vector{Float64}:
 2.0101794452888404
 2.0478837265905776
 0.1782501851835805
 0.8996594911947726
 0.9664497324725565
 2.78625451591419
 0.6425373668586762
 ⋮
 0.37713666489254616
 2.410428905182866
 0.6206431229054068
 0.7394542991389228
 2.0090696372511574
 0.5181889016894681</pre>


<div class="markdown"><h3>Question 4</h3>
<p>For logistic regression, the model can be written as </p>
<p class="tex">$$P&#40;y|\boldsymbol&#123;x&#125;&#41; &#61; \text&#123;Bernoulli&#125;&#40;\sigma&#40;\boldsymbol&#123;x&#125;^\top \boldsymbol&#123;\beta&#125;&#41;&#41;,$$</p>
<p>Given data <span class="tex">$\boldsymbol&#123;y&#125; &#61; &#91;y_1, y_2, \ldots, y_n&#93;^\top$</span> where <span class="tex">$y_i \in \&#123;0, 1\&#125;$</span> and <span class="tex">$\boldsymbol&#123;X&#125; &#61; &#91;\boldsymbol&#123;x&#125;_1, \boldsymbol&#123;x&#125;_2, \ldots, \boldsymbol&#123;x&#125;_n&#93;^\top$</span>;</p>
<ul>
<li><p>what is <span class="tex">$E&#91;y|\boldsymbol&#123;x&#125;&#93;$</span> ? Plot <span class="tex">$E&#91;y|\boldsymbol&#123;x&#125;&#93;$</span> by 3-d surface or 2-d contour plot.</p>
</li>
<li><p>what are the paremeter for this model ?</p>
</li>
<li><p>what is the likelihood function ?</p>
</li>
<li><p>simulate <span class="tex">$\boldsymbol&#123;y&#125;$</span> based on the given model &#40;<span class="tex">$\boldsymbol&#123;\beta&#125;$</span> and <span class="tex">$\boldsymbol&#123;X&#125;$</span> are already given below&#41;</p>
</li>
<li><p>maximise the log-likelihood function by &#40;you should implement the algorithm in Julia&#41;</p>
<ul>
<li><p>gradient descent</p>
</li>
<li><p>Newton&#39;s method</p>
</li>
</ul>
</li>
</ul>
</div>

<pre class='language-julia'><code class='language-julia'>begin
# 	number of dimensions 
    dim₄ = 2
# 	number of observations
    n₄ = 100
# 	a n*m matrix, for this case there is no intercept term, or equivalently $\beta_0 = 0$
    X₄ = rand(n₄,dim₄)
# 	make X₄ ranging between -10 to 10
    X₄ = X₄ .* 20 .- 10.0
    β₄ = rand(dim₄)	
end</code></pre>
<pre id='var-dim₄' class='code-output documenter-example-output'>2-element Vector{Float64}:
 0.9272746468415421
 0.6641677470386047</pre>


<div class="markdown"><h2>Extra exercises*</h2>
<p>You can try the following to test your understanding after the meeting.</p>
<h3>Question 4</h3>
<p>For Poisson regression &#40;where observations <span class="tex">$y$</span> are usually counting data, say web page visitor counts etc.&#41;, the model can be written as </p>
<p class="tex">$$P&#40;y|\boldsymbol&#123;x&#125;&#41; &#61; \text&#123;Poisson&#125;&#40;\exp&#40;\boldsymbol&#123;x&#125;^\top \boldsymbol&#123;\beta&#125;&#41;&#41;,$$</p>
<p>Given data <span class="tex">$\boldsymbol&#123;y&#125; &#61; &#91;y_1, y_2, \ldots, y_n&#93;^\top$</span> where <span class="tex">$y_i \in \&#123;0, 1, 2,\ldots\&#125;$</span> and <span class="tex">$\boldsymbol&#123;X&#125; &#61; &#91;\boldsymbol&#123;x&#125;_1, \boldsymbol&#123;x&#125;_2, \ldots, \boldsymbol&#123;x&#125;_n&#93;^\top$</span>;</p>
<ul>
<li><p>What is <span class="tex">$E&#91;y|\boldsymbol&#123;x&#125;&#93;$</span> ?</p>
</li>
<li><p>What are the paremeter for this model ?</p>
</li>
<li><p>What is the likelihood function ?</p>
</li>
<li><p>Simulate <span class="tex">$\boldsymbol&#123;y&#125;$</span> based on the given model </p>
</li>
<li><p>Maximise the log-likelihood function by &#40;implement the algorithm in Julia&#41;</p>
<ul>
<li><p>gradient descent</p>
</li>
<li><p>Newton&#39;s method</p>
</li>
</ul>
</li>
</ul>
</div>

<pre class='language-julia'><code class='language-julia'>begin
    # 	number of dimensions 
    dim₅ = 5
# 	number of observations
    n₅ = 100
# 	a n*m matrix, for this case there is no intercept term, or equivalently $\beta_0 = 0$
    X₅ = rand(n₅,dim₅) *2 .-1
    β₅ = rand(dim₅)	
end</code></pre>
<pre id='var-dim₅' class='code-output documenter-example-output'>5-element Vector{Float64}:
 0.9445250168724828
 0.8916614184572569
 0.522219278770481
 0.24289289073241127
 0.2668012488217967</pre>


<div class="markdown"><h3>Question 5</h3>
<p>For Geometric regression &#40;where observations <span class="tex">$y$</span> are usually counting data, say how many times you need to try until success&#41;, the model can be written as </p>
<p class="tex">$$P&#40;y|\boldsymbol&#123;x&#125;&#41; &#61; \text&#123;Geometric&#125;&#40;\sigma&#40;\boldsymbol&#123;x&#125;^\top \boldsymbol&#123;\beta&#125;&#41;&#41;,$$</p>
<p>Given data <span class="tex">$\boldsymbol&#123;y&#125; &#61; &#91;y_1, y_2, \ldots, y_n&#93;^\top$</span> where <span class="tex">$y_i \in \&#123;0, 1, 2,\ldots\&#125;$</span> and <span class="tex">$\boldsymbol&#123;X&#125; &#61; &#91;\boldsymbol&#123;x&#125;_1, \boldsymbol&#123;x&#125;_2, \ldots, \boldsymbol&#123;x&#125;_n&#93;^\top$</span>;</p>
<ul>
<li><p>What is <span class="tex">$E&#91;y|\boldsymbol&#123;x&#125;&#93;$</span> ?</p>
</li>
<li><p>What are the paremeter for this model ?</p>
</li>
<li><p>What is the likelihood function ?</p>
</li>
<li><p>Simulate <span class="tex">$\boldsymbol&#123;y&#125;$</span> based on the given model </p>
</li>
<li><p>Maximise the log-likelihood function by &#40;implement the algorithm in Julia&#41;</p>
<ul>
<li><p>gradient descent</p>
</li>
<li><p>Newton&#39;s method</p>
</li>
</ul>
</li>
</ul>
</div>

<!-- PlutoStaticHTML.End -->